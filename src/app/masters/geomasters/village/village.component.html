<div class="col-12">
  <div class="card">
    <p-dialog header="Village" [(visible)]="display" showEffect="fade"
      [breakpoints]="{'960px': '75vw', '640px': '100vw'}" [style]="{width: '70vw'}">
      <ng-template pTemplate="content">
        <div class="flex flex-column align-items-center justify-content-center">
          <form [formGroup]="fbvillages" (ngSubmit)="onSubmit()">
            <div class="container">
              <div class="grid p-fluid">
                <p-fieldset legend="Geographic Info" class="col-12" [toggleable]="true" [transitionOptions]="'500ms'">
                  <div class="grid p-fluid">
                    <div class="field col-12 md:col-4">
                      <label htmlFor="age1">Division:<sup class="p-error">*</sup></label>
                      <p-dropdown [options]="divisions" optionLabel="divisionName" [required]="true"
                        optionValue="divisionId" (onChange)="initCircles($event.value)" [autoDisplayFirst]="false"
                        [(ngModel)]="selectedVillage.divisionId" #divisionId="ngModel"
                        [ngModelOptions]="{standalone: true}"
                        [ngClass]="{ 'is-invalid ng-dirty': divisionId.touched && divisionId.errors }"></p-dropdown>
                      <span *ngIf="divisionId.touched && divisionId.invalid">
                        <div class="ng-invalid ng-touched p-error" *ngIf="divisionId.errors?.['required']">Please Select
                          Division.
                        </div>
                      </span>
                    </div>
                    <div class="field col-12 md:col-4">
                      <label htmlFor="circle">Circle:<sup class="p-error">*</sup></label>
                      <p-dropdown [options]="circles" optionLabel="name" [required]="true" optionValue="circleId"
                        (onChange)="initSections($event.value)" [autoDisplayFirst]="false"
                        [(ngModel)]="selectedVillage.circleId" #circleId="ngModel" [ngModelOptions]="{standalone: true}"
                        [ngClass]="{ 'is-invalid ng-dirty': circleId.touched && circleId.errors }">
                      </p-dropdown>
                      <span *ngIf="circleId.touched && circleId.invalid">
                        <div class="ng-invalid ng-touched p-error" *ngIf="circleId.errors?.['required']">Please Select
                          Circle.
                        </div>


                      </span>
                    </div>
                    <div class="field col-12 md:col-4">
                      <label htmlFor="section">Sections:<sup class="p-error">*</sup></label>
                      <p-dropdown [options]="sections" optionLabel="name" [(ngModel)]="village.sectionId"
                        [required]="true" optionValue="sectionId" [autoDisplayFirst]="false" #sectionId="ngModel"
                        [ngModelOptions]="{standalone: true}"
                        [ngClass]="{ 'is-invalid ng-dirty': sectionId.touched && sectionId.errors }">
                      </p-dropdown>
                      <span *ngIf="sectionId?.touched && sectionId.invalid">
                        <div class="ng-invalid ng-touched p-error" *ngIf="sectionId.errors?.['required']">Please Select
                          Section.
                        </div>
                      </span>
                    </div>
                    <div class="field col-12 md:col-4">
                      <label htmlFor="age1">State:<sup class="p-error">*</sup></label>
                      <p-dropdown [options]="states" optionLabel="name" [required]="true" optionValue="stateId"
                        (onChange)="initDistricts($event.value)" [autoDisplayFirst]="false"
                        [(ngModel)]="selectedVillage.stateId" #stateId="ngModel" [ngModelOptions]="{standalone: true}"
                        [ngClass]="{ 'is-invalid ng-dirty': stateId?.touched && stateId?.errors }"></p-dropdown>
                      <span *ngIf="stateId?.touched && stateId?.invalid">
                        <div class="ng-invalid ng-touched p-error" *ngIf="stateId.errors?.['required']">Please Select
                          State.
                        </div>
                      </span>
                    </div>
                    <div class="field col-12 md:col-4">
                      <label htmlFor="districtId">Districts:<sup class="p-error">*</sup></label>
                      <p-dropdown [options]="districts" optionLabel="name" [required]="true" optionValue="districtId"
                        (onChange)="initMandals($event.value)" [autoDisplayFirst]="false"
                        [(ngModel)]="selectedVillage.districtId" #districtId="ngModel"
                        [ngModelOptions]="{standalone: true}"
                        [ngClass]="{ 'is-invalid ng-dirty': districtId?.touched && districtId.errors }">
                      </p-dropdown>
                      <span *ngIf="districtId?.touched && districtId?.invalid">
                        <div class="ng-invalid ng-touched p-error" *ngIf="districtId?.errors?.['required']">Please
                          Select District.
                        </div>
                      </span>
                    </div>
                    <div class="field col-12 md:col-4">
                      <label htmlFor="circle">Mandals:<sup class="p-error">*</sup></label>
                      <p-dropdown [options]="mandals" optionLabel="name" [(ngModel)]="village.mandalId"
                        [required]="true" optionValue="mandalId" [autoDisplayFirst]="false" #mandalId="ngModel"
                        [ngModelOptions]="{standalone: true}"
                        [ngClass]="{ 'is-invalid ng-dirty': mandalId.touched && mandalId.errors }">
                      </p-dropdown>
                      <span *ngIf="mandalId?.touched && mandalId.invalid">
                        <div class="ng-invalid ng-touched p-error" *ngIf="mandalId.errors?.['required']">Please Select
                          Mandals.
                        </div>
                      </span>
                    </div>
                  </div>
                </p-fieldset>

                <p-fieldset legend="Village Info" class="col-12" [toggleable]="true" [transitionOptions]="'500ms'">
                  <div class="grid p-fluid">
                    <div class="field col-12 md:col-3">
                      <label for="code">Village Code:<sup class="p-error">*</sup></label>
                      <input pInputText inputId="code" formControlName="code" type="text" />
                      <div *ngIf="FormControls['code'].invalid &&  FormControls['code'].touched"
                        class="error-message p-error">
                        Village Code required
                      </div>


                    </div>

                    <div class="field col-12 md:col-3">
                      <label htmlFor="name">Village Name:<sup class="p-error">*</sup></label>
                      <input pInputText id="name" formControlName="name" type="text" />
                      <div *ngIf="FormControls['name'].invalid &&  FormControls['name'].touched"
                        class="error-message p-error">
                        Village Name required
                      </div>
                    </div>


                    <div class="field col-12 md:col-3">
                      <label for="inchargeName">Incharge Name:</label>
                      <input pInputText id="inchargeName" formControlName="inchargeName" type="text" />


                    </div>
                    <div class="field col-12 md:col-3">
                      <label for="inchargePhoneNo">Incharge Phone No.:</label>
                      <p-inputNumber inputId="inchargePhoneNo" formControlName="inchargePhoneNo" inputId="minmax"
                        mode="decimal" [min]="0" [max]="100">
                      </p-inputNumber>
                    </div>



                    <div class="field col-8 md:col-3">
                      <label htmlFor="address">Address:</label>
                      <textarea rows="5" cols="30" formControlName="address" placeholder="Village Address"
                        pInputTextarea></textarea>

                    </div>
                    <div class="field col-12 md:col-3">
                      <label for="PinCode">Pin Code:</label>
                      <p-inputNumber inputId="pinCode" formControlName="pinCode">
                      </p-inputNumber>


                    </div>

                    <div class="field col-12 md:col-3">
                      <label for="distance">Distance:<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="distance" formControlName="distance" [minFractionDigits]="2">
                      </p-inputNumber>
                      <div *ngIf="FormControls['distance'].invalid &&  FormControls['distance'].touched"
                        class="error-message p-error">
                        Distance required
                      </div>
                    </div>
                    <div class="field col-12 md:col-3">
                      <label for="divertedDistance">Diverted Distance:<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="divertedDistance" formControlName="divertedDistance"
                        [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['divertedDistance'].invalid &&  FormControls['divertedDistance'].touched"
                        class="error-message p-error">
                        Diverted Distance required
                      </div>
                    </div>

                  </div>
                </p-fieldset>

                <p-fieldset legend="Land Info" class="col-12" [toggleable]="true" [transitionOptions]="'500ms'">
                  <div class="grid p-fluid">

                    <div class="field col-12 md:col-3">
                      <label for="cultivableArea">Cultivatable Area(Acres):<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="cultivableArea" formControlName="cultivableArea" [minFractionDigits]="2">
                      </p-inputNumber>
                      <div *ngIf="FormControls['cultivableArea'].invalid &&  FormControls['cultivableArea'].touched"
                        class="error-message p-error">
                        Cultivatable Area is required
                      </div>
                    </div>


                    <div class="field col-12 md:col-3">
                      <label for="irrigationArea">Irrigation Area(In Peek Summer):<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="irrigationArea" formControlName="irrigationArea" [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['irrigationArea'].invalid &&  FormControls['irrigationArea'].touched"
                        class="error-message p-error">
                        Irrigation Area is required
                      </div>
                    </div>
                    <div class="field col-12 md:col-3">
                      <label for="potentialArea">Suitable Area for Cane(Acres):<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="potentialArea" formControlName="potentialArea" mode="decimal"
                        locale="en-US" [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['potentialArea'].invalid &&  FormControls['potentialArea'].touched"
                        class="error-message p-error">
                        Suitable Area for Cane is required
                      </div>
                    </div>

                    <div class="field col-12 md:col-3">
                      <label for="totalArea">Total Geographic Area(Acres):<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="totalArea" formControlName="totalArea" [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['totalArea'].invalid &&  FormControls['totalArea'].touched"
                        class="error-message p-error">
                        Total Geographic Area is required
                      </div>
                    </div>

                    <div class="field col-12 md:col-4">
                      <label for="dryArea">Dry Area(Acres):<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="dryArea" formControlName="dryArea" [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['dryArea'].invalid &&  FormControls['dryArea'].touched"
                        class="error-message p-error">
                        Dry Area is required
                      </div>
                    </div>

                    <div class="field col-12 md:col-4">
                      <label for="notSuitableArea">Not Suitable:<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="notSuitableArea" formControlName="notSuitableArea" mode="decimal"
                        locale="de-DE" [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['notSuitableArea'].invalid &&  FormControls['notSuitableArea'].touched"
                        class="error-message p-error">
                        Not Suitable is requiredF
                      </div>
                    </div>

                    <div class="field col-12 md:col-4">
                      <label for="target">Target Area</label>
                      <p-inputNumber formControlName="targetArea" inputId="target">
                      </p-inputNumber>

                    </div>



                    <div class="field col-12 md:col-4">
                      <label for="noOfEbservices">No Of EB Services:<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="noOfEbservices" formControlName="noOfEbservices" [minFractionDigits]="2">
                      </p-inputNumber>
                      <div *ngIf="FormControls['noOfEbservices'].invalid &&  FormControls['noOfEbservices'].touched"
                        class="error-message p-error">
                        No Of EB Services is required
                      </div>
                    </div>
                    <div class="field col-12 md:col-4">
                      <label for="tptrate">TPT Rate(₹):<sup class="p-error">*</sup></label>
                      <p-inputNumber inputId="tptRate" formControlName="tptrate" [minFractionDigits]="2">
                      </p-inputNumber>

                      <div *ngIf="FormControls['tptrate'].invalid &&  FormControls['tptrate'].touched"
                        class="error-message p-error">
                        TPT Rate is required
                      </div>
                    </div>





                  </div>

                </p-fieldset>

                <div class="field col-12 md:col-3 ">
                  <div class="col-6">
                    <label htmlFor="isActive">Is Active?:<sup class="p-error">*</sup></label><br>
                    <p-inputSwitch [(ngModel)]="valSwitch" formControlName="isActive"></p-inputSwitch>

                    <div *ngIf="FormControls['isActive'].invalid &&  FormControls['isActive'].touched"
                      class="error-message p-error">
                      IsActive is required
                    </div>
                  </div>
                </div>
                <div class="field col-12 md:col-3">
                  <label for="listingOrder">Listing Order:<sup class="p-error">*</sup></label>
                  <p-inputNumber inputId="locale-indian" formControlName="listingOrder" mode="decimal" [min]="0" [max]="1000"
                    locale="en-IN">
                  </p-inputNumber>
                  <div *ngIf="FormControls['listingOrder'].invalid &&  FormControls['listingOrder'].touched"
                    class="error-message p-error">
                    Listing Order is required
                  </div>
                </div>

              </div>
            </div>
          </form>
        </div>
      </ng-template>
      <ng-template pTemplate="footer">
        <div class="col-12">
          <div class="col-4" style="float:right">
            <button pButton pRipple type="submit" [label]="submitLabel" class="p-button-raised p-button-success"
              (click)="onSubmit()"></button>
          </div>
        </div>
      </ng-template>
    </p-dialog>

    <p-toolbar styleClass="p-mb-4">
      <ng-template pTemplate="left">
        <h4>Villages</h4>
      </ng-template>
      <ng-template pTemplate="right">
        <button pButton pRipple label="New Village" icon="pi pi-plus" class="p-button-success p-mr-2"
          (click)="InitVillage({})"></button>
      </ng-template>
    </p-toolbar>

    <p-table #dt1 [value]="villages" dataKey="id" [rows]="10" [loading]="loading" [rowHover]="true"
      styleClass="p-datatable-gridlines p-datatable-striped p-datatable-sm" [paginator]="true"
      [globalFilterFields]="['name','country.name','representative.name','status']" [autoLayout]="true"
      responsiveLayout="scroll" [rowsPerPageOptions]="[10,25,50]" [tableStyle]="{ width: 'max-content'}">
      <ng-template pTemplate="caption">
        <div class="flex justify-content-between flex-column sm:flex-row">
          <button pButton label="Clear" class="p-button-outlined mb-2" icon="pi pi-filter-slash"
            (click)="clear(dt1)"></button>
          <span class="p-input-icon-left mb-2">
            <i class="pi pi-search"></i>
            <input pInputText type="text" #filter (input)="onGlobalFilter(dt1, $event)" placeholder="Search Keyword"
              class="w-full" />
          </span>
        </div>
      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th></th>
          <th pSortableColumn="villageId"><p-sortIcon field="villageId"></p-sortIcon>Village Id</th>
          <th pSortableColumn="villageCode"><p-sortIcon field="villageCode"></p-sortIcon>Village Code</th>
          <th pSortableColumn="villageName"><p-sortIcon field="villageName"></p-sortIcon>Village Name</th>
          <th pSortableColumn="sectionId"><p-sortIcon field="sectionId"></p-sortIcon>Section Id</th>
          <th pSortableColumn="sectionName"><p-sortIcon field="sectionName"></p-sortIcon>Section NAme</th>
          <th pSortableColumn="mandalId"><p-sortIcon field="mandalId"></p-sortIcon>Mandal Id</th>
          <th pSortableColumn="mandalName"><p-sortIcon field="mandalName"></p-sortIcon>Mandal Name</th>
          <th pSortableColumn="districtId"><p-sortIcon field="districtId"></p-sortIcon>District Id</th>
          <th pSortableColumn="districtName"><p-sortIcon field="districtName"></p-sortIcon>District Name</th>
          <th pSortableColumn="divisionId"><p-sortIcon field="divisionId"></p-sortIcon>Division Id</th>
          <th pSortableColumn="divisionName"><p-sortIcon field="divisionName"></p-sortIcon>Division Name</th>
          <th pSortableColumn="circleId"><p-sortIcon field="circleId"></p-sortIcon>Circle Id</th>
          <th pSortableColumn="circleName"><p-sortIcon field="circleName"></p-sortIcon>Circle Name</th>
          <th pSortableColumn="inchargeName"><p-sortIcon field="inchargeName"></p-sortIcon>Incharge Name</th>
          <th pSortableColumn="inchargePhoneNo"><p-sortIcon field="inchargePhoneNo"></p-sortIcon>Incharge
            Phone No</th>
          <th pSortableColumn="address"><p-sortIcon field="address"></p-sortIcon>Address</th>
          <th pSortableColumn="pinCode"><p-sortIcon field="pinCode"></p-sortIcon>Pincode</th>
          <th pSortableColumn="distance"><p-sortIcon field="distance"></p-sortIcon>Distance</th>
          <th pSortableColumn="divertedDistance"><p-sortIcon field="divertedDistance"></p-sortIcon>Diverted
            Distance</th>
          <th pSortableColumn="noOfEbservices"><p-sortIcon field="noOfEbservices"></p-sortIcon>No of
            Ebservices</th>
          <th pSortableColumn="tptRate"><p-sortIcon field="tptRate"></p-sortIcon>Tpt Rate</th>
          <th pSortableColumn="totalArea"><p-sortIcon field="totalArea"></p-sortIcon>Total Area</th>
          <th pSortableColumn="cultivableArea"><p-sortIcon field="cultivableArea"></p-sortIcon>Cultivable
            Area</th>
          <th pSortableColumn="irrigationArea"><p-sortIcon field="irrigationArea"></p-sortIcon>Irrigation
            Area</th>
          <th pSortableColumn="dryArea"><p-sortIcon field="dryArea"></p-sortIcon>Dry Area</th>
          <th pSortableColumn="potentialArea"><p-sortIcon field="potentialArea"></p-sortIcon>Potential Area
          </th>
          <th pSortableColumn="notSuitableArea"><p-sortIcon field="notSuitableArea"></p-sortIcon>Not
            Suitable Area</th>
          <th pSortableColumn="targetTons"><p-sortIcon field="targetTons"></p-sortIcon>Target Tons</th>
          <th pSortableColumn="listingOrder"><p-sortIcon field="listingOrder"></p-sortIcon>Listing Order</th>
          <th pSortableColumn="isActive"><p-sortIcon field="isActive"></p-sortIcon>Is Active</th>
          <th pSortableColumn="updatedAt"><p-sortIcon field="updatedAt"></p-sortIcon>Updated At</th>
          <th pSortableColumn="createdAt"><p-sortIcon field="createdAt"></p-sortIcon>Created At</th>
          <th pSortableColumn="updatedBy"><p-sortIcon field="updatedBy"></p-sortIcon>Updated By</th>
          <th pSortableColumn="createdBy"><p-sortIcon field="createdBy"></p-sortIcon>Created By</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-village>
        <tr>
          <td><button pButton pRipple icon="pi pi-pencil" class="p-element p-ripple p-button-text p-button p-component"
              (click)="InitVillage(village)"></button></td>
          <td>{{village.villageId}}</td>
          <td>{{village.villageCode}}</td>
          <td>{{village.villageName}}</td>
          <td>{{village.sectionId}}</td>
          <td>{{village.sectionName}}</td>
          <td>{{village.mandalId}}</td>
          <td>{{village.mandalName}}</td>
          <td>{{village.districtId}}</td>
          <td>{{village.districtName}}</td>
          <td>{{village.divisionId}}</td>
          <td>{{village.divisionName}}</td>
          <td>{{village.circleId}}</td>
          <td>{{village.circleName}}</td>
          <td>{{village.inchargeName}}</td>
          <td>{{village.inchargePhoneNo}}</td>
          <td>{{village.address}}</td>
          <td>{{village.pinCode}}</td>
          <td>{{village.distance}}</td>
          <td>{{village.divertedDistance}}</td>
          <td>{{village.noOfEbservices}}</td>
          <td>{{village.tptRate}}</td>
          <td>{{village.totalArea}}</td>
          <td>{{village.cultivableArea}}</td>
          <td>{{village.irrigationArea}}</td>
          <td>{{village.dryArea}}</td>
          <td>{{village.potentialArea}}</td>
          <td>{{village.notSuitableArea}}</td>
          <td>{{village.targetTons}}</td>
          <td>{{village.listingOrder}}</td>
          <td>{{village.isActive}}</td>
          <td>{{village.updatedAt}}</td>
          <td>{{village.createdAt}}</td>
          <td>{{village.updatedBy}}</td>
          <td>{{village.createdBy}}</td>

        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="8">No Villages found.</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="loadingbody">
        <tr>
          <td colspan="8">Loading.. Villages data. Please wait.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

</div>
